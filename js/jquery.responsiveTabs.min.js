/*
 *  Project: responsiveTabs.js
 *  Description: A plugin that creates responsive tabs, optimized for all devices
 *  Author: Jelle Kralt (jelle@jellekralt.nl)
 *  License: MIT
 */(function(e,t,n){function i(t,n){this.element=t;this.$element=e(t);this.tabs=[];this.state="";this.rotateInterval=0;this.options=e.extend({},r,n);this.init()}var r={collapsible:false,startCollapsed:false,rotate:false,setHash:false,activate:function(){},deactivate:function(){},load:function(){},activateState:function(){},classes:{stateDefault:"r-tabs-state-default",stateActive:"r-tabs-state-active",tab:"r-tabs-tab",anchor:"r-tabs-anchor",panel:"r-tabs-panel",accordionTitle:"r-tabs-accordion-title"}};i.prototype.init=function(){var n=this;this.tabs=this.loadElements();this.loadClasses();this.loadEvents();e(t).on("resize",function(e){n.setState(e)});e(t).on("hashchange",function(e){var r=n.getTabRefBySelector(t.location.hash);if(r>=0){n.openTab(e,n.getTab(r),true)}});if(this.options.rotate!==false){this.startRotation()}this.$element.bind("tabs-activate",function(e){n.options.activate.call(this,e)});this.$element.bind("tabs-deactivate",function(e){n.options.deactivate.call(this,e)});this.$element.bind("tabs-load",function(e){var r=n.getTabRefBySelector(t.location.hash);var i;n.setState(e);if(n.options.startCollapsed!==true&&!(n.options.startCollapsed==="accordion"&&n.state==="accordion")){if(r>=0){i=n.getTab(r)}else{i=n.getTab(0)}n.openTab(e,i);n.options.load.call(this,e,i)}});this.$element.trigger("tabs-load")};i.prototype.loadElements=function(){var t=this.$element.children("ul");var n=[];this.$element.addClass("r-tabs");t.addClass("r-tabs-nav");e("li",t).each(function(){var t=e(this);var r=e("a",t);var i=r[0].getAttribute("href");var s=e(i);var o=e("<div></div>").insertBefore(s);var u=e("<a></a>").attr("href",i).html(r.html()).appendTo(o);var a={tab:e(this),anchor:e("a",t),panel:s,selector:i,accordionTab:o,accordionAnchor:u,active:false};n.push(a)});return n};i.prototype.loadClasses=function(){for(var e=0;e<this.tabs.length;e++){this.tabs[e].tab.addClass(this.options.classes.stateDefault).addClass(this.options.classes.tab);this.tabs[e].anchor.addClass(this.options.classes.anchor);this.tabs[e].panel.addClass(this.options.classes.stateDefault).addClass(this.options.classes.panel);this.tabs[e].accordionTab.addClass(this.options.classes.accordionTitle);this.tabs[e].accordionAnchor.addClass(this.options.classes.anchor)}};i.prototype.loadEvents=function(){var e=this;var n=function(n){var r=e.getCurrentTab();var i=n.data.tab;n.preventDefault();if(e.options.setHash){t.location.hash=i.selector}e.closeTab(n,r);if(e.options.collapsible===false||e.options.collapsible&&r!==i){e.openTab(n,i,false,true)}};for(var r=0;r<this.tabs.length;r++){this.tabs[r].anchor.on("click",{tab:e.tabs[r]},n);this.tabs[r].accordionAnchor.on("click",{tab:e.tabs[r]},n)}};i.prototype.setState=function(t){var n=e("ul",this.$element);var r=this.state;if(n.is(":visible")){this.state="tabs"}else{this.state="accordion"}if(this.state!==r){this.$element.trigger("tabs-activate-state",t,{oldState:r,newState:this.state})}};i.prototype.openTab=function(e,t,n,r){if(n){this.closeTab(e,this.getCurrentTab())}if(r&&this.rotateInterval>0){this.stopRotation()}t.active=true;t.tab.removeClass(this.options.classes.stateDefault).addClass(this.options.classes.stateActive);t.panel.removeClass(this.options.classes.stateDefault).addClass(this.options.classes.stateActive);t.accordionTab.removeClass(this.options.classes.stateDefault).addClass(this.options.classes.stateActive);this.$element.trigger("tabs-activate",e,t)};i.prototype.closeTab=function(e,t){if(t!==n){t.active=false;t.tab.removeClass(this.options.classes.stateActive).addClass(this.options.classes.stateDefault);t.panel.removeClass(this.options.classes.stateActive).addClass(this.options.classes.stateDefault);t.accordionTab.removeClass(this.options.classes.stateActive).addClass(this.options.classes.stateDefault);this.$element.trigger("tabs-deactivate",e,t)}};i.prototype.getTab=function(e){return this.tabs[e]};i.prototype.getTabRefBySelector=function(e){for(var t=0;t<this.tabs.length;t++){if(this.tabs[t].selector===e){return t}}return-1};i.prototype.getCurrentTab=function(){return this.getTab(this.getCurrentTabRef())};i.prototype.getNextTabRef=function(){var e=this.getCurrentTabRef();if(e===this.tabs.length-1){return 0}else{return e+1}};i.prototype.getPreviousTabRef=function(){var e=this.getCurrentTabRef();if(e===0){return this.tabs.length-1}else{return e-1}};i.prototype.getCurrentTabRef=function(){for(var e=0;e<this.tabs.length;e++){if(this.tabs[e].active){return e}}return-1};i.prototype.startRotation=function(){var t=this;this.rotateInterval=setInterval(function(){var e=jQuery.Event("rotate");t.openTab(e,t.getTab(t.getNextTabRef()),true)},e.isNumeric(t.options.rotate)?t.options.rotate:4e3)};i.prototype.stopRotation=function(){t.clearInterval(this.rotateInterval);this.rotateInterval=0};e.fn.responsiveTabs=function(t){var r=arguments;if(t===n||typeof t==="object"){return this.each(function(){if(!e.data(this,"responsivetabs")){e.data(this,"responsivetabs",new i(this,t))}})}else if(typeof t==="string"&&t[0]!=="_"&&t!=="init"){return this.each(function(){var n=e.data(this,"responsivetabs");if(n instanceof i&&typeof n[t]==="function"){n[t].apply(n,Array.prototype.slice.call(r,1))}if(t==="destroy"){e.data(this,"responsivetabs",null)}})}}})(jQuery,window)